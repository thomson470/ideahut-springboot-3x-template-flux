const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Search-BYjaRapV.js","assets/format-CGhROzcI.js","assets/index-DHD4YuRL.js","assets/index-G0ic_0eP.css","assets/QTooltip-BF_G_uWg.js","assets/QTabPanels-BDvRJGNV.js","assets/QResizeObserver-D1Jp1oLS.js","assets/QTable-_w2CDqAD.js","assets/TouchPan-jmEJS9YP.js","assets/QPopupProxy-Btg3RRTJ.js","assets/QForm-DNR0ZqNO.js","assets/ClosePopup-BUscyfOW.js","assets/Index-CmRT2k02.js","assets/QSpace-1hX8bodH.js","assets/QInnerLoading-D79c4tOQ.js","assets/QSpinnerGears-u5VfzIwZ.js","assets/View2-Bd9w8OWQ.js","assets/Edit2-DoN0NyuW.js","assets/QFab-CkvX6-x7.js"])))=>i.map(i=>d[i]);
import{_ as U,ag as h,Y as y,a7 as k,$ as s,f as t,a0 as r,C,Z as d,a2 as f,ai as v,a1 as q,a4 as Q,a5 as _,a3 as m,F as R,a8 as E,a9 as u,aj as T,an as z,ao as P,G as N,ah as L,al as V,r as p,am as x}from"./index-DHD4YuRL.js";import{Q as B,b as j,a as A,e as F}from"./format-CGhROzcI.js";import{Q as G}from"./QTooltip-BF_G_uWg.js";import{d as Y,Q as Z}from"./QTable-_w2CDqAD.js";import{Q as H}from"./QSpace-1hX8bodH.js";import{Q as J}from"./QInnerLoading-D79c4tOQ.js";import{T as S}from"./TouchPan-jmEJS9YP.js";import{c as l}from"./Index-CmRT2k02.js";import"./QSpinnerGears-u5VfzIwZ.js";let e;const K={props:["parameters"],emits:["close"],components:{Search:h(()=>x(()=>import("./Search-BYjaRapV.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15]))),View2:h(()=>x(()=>import("./View2-Bd9w8OWQ.js"),__vite__mapDeps([16,2,3,1,4,11,8,12,13,7,14,15]))),Edit2:h(()=>x(()=>import("./Edit2-DoN0NyuW.js"),__vite__mapDeps([17,2,3,1,4,7,5,6,8,9,18,11,12,13,14,15])))},setup(){return{crud:l,template:p({}),definition:p({}),permission:p({}),parentRow:p({}),relations:p([]),onlyView:p(!1),replica:p(null),labels:p([]),chips:["red-10","deep-purple-10","light-blue-10","brown-10","deep-orange-10","blue-grey-10"],dialog:p({main:l.dialog.init(()=>e.dialog.main),search:l.dialog.init(()=>e.dialog.search),view:l.dialog.init(),edit:l.dialog.init()}),search:p({filters:[],empty:!0}),table:p({rows:[],columns:[],visibles:[],selected:[],pagination:{},loading:!1,deleting:!1,separator:"none"})}},created(){e=this;let o=l.get.object(e.parameters);e.template=l.get.object(o.template),e.definition=l.get.object(o.definition),e.parentRow=l.get.object(o.parentRow),e.relations=l.get.array(o.relations),e.replica=l.callIf(l.isString(e.definition?.crud?.replica),()=>l.getFieldValue(e.definition.crud.replica,e.parentRow),()=>l.get.number(o.replica,null)),e.onlyView=l.isDefined(e.definition.onlyView)?e.definition.onlyView===!0:o.onlyView===!0,e.permission={actions:l.copy(e.template.actions)};let n=e.definition?.action?.exclude?e.definition.action.exclude:[];if(e.permission.actions=e.template.actions.filter(b=>!n.includes(b)),e.search={empty:!0,filters:l.copy(l.get.array(e.definition.table.filters))},e.table={rows:[],columns:e.definition.table.columns,visibles:e.definition.table.visibles,selected:[],pagination:{page:1,rowsPerPage:e.definition.table.page.default,sortBy:e.definition.table.order.field,descending:e.definition.table.order.descending===!0},loading:!1,deleting:!1,separator:l.isString(e.definition.table.separator)?e.definition.table.separator:"none"},e.labels=[],l.isArray(e.definition.labels))for(const b of e.definition.labels){let i=l.copy(b);l.isString(i.value)&&(i.value=l.getFieldValue(i.value,e.parentRow),e.labels.push(i))}e.do_request({pagination:e.table.pagination})},methods:{do_request(o){l.action.page({parentRow:e.parentRow,props:o,table:e.table,search:e.search,definition:e.definition,replica:e.definition.enableReplica===!0?e.replica:null,relations:e.relations})},on_close_click(){e.$emit("close")},on_refresh_click(){e.do_request({pagination:e.table.pagination})},on_delete_click(o){l.action.delete({row:o.row,definition:e.definition,table:e.table,replica:e.replica,onSuccess:function(){e.do_request({pagination:e.table.pagination})},onProgress:n=>e.table.deleting=n})},on_search_click(){l.dialog.show(e.dialog.search,{filters:l.copy(e.search.filters),template:e.template})},on_close_dialog_search(o){if(l.isArray(o)){let n=e.search,b,i;n.filters=o,n.empty=!0;for(const w of n.filters)if(b=l.isDefined(w.value)?w.value:"",i=l.isDefined(w.value2)?w.value2:"",b!==""||i!==""){n.empty=!1;break}l.dialog.hide(e.dialog.search),e.table.pagination.page=1,e.do_request({pagination:e.table.pagination})}},on_view_click(o){l.dialog.show(e.dialog.view,{parentRow:e.parentRow,row:o.row,template:e.template,replica:e.replica,definition:e.definition,onlyView:e.onlyView})},on_edit_click(o){l.dialog.show(e.dialog.edit,{parentRow:e.parentRow,row:o.row,template:e.template,replica:e.replica,definition:e.definition,index:o.rowIndex,relations:e.relations})},on_add_click(){l.dialog.show(e.dialog.edit,{parentRow:e.parentRow,template:e.template,replica:e.replica,definition:e.definition,relations:e.relations})},on_close_dialog_edit(o){let n=o?.row;if(n)if(o.is_edit)if(l.isDefined(n._pk_))e.table.rows[o.index]=n;else{l.dialog.hide(e.dialog.edit),setTimeout(function(){l.dialog.show(e.dialog.edit,{row:n,parentRow:e.parentRow,template:e.template,replica:e.replica,definition:e.definition,relations:e.relations})},100);return}else e.do_request({pagination:e.table.pagination});l.dialog.hide(e.dialog.edit)},on_page_changed(){let o=+e.table.pagination.page;!isNaN(o)&&o>0&&e.do_request({pagination:e.table.pagination})}}},M={class:"q-ml-sm"},W={class:"full-width row flex-center text-accent q-gutter-sm"},X={class:"text-subtitle2"},$={key:0,class:"text-left"},ee={class:"text-caption"};function ie(o,n,b,i,w,c){const D=y("Search"),O=y("View2"),I=y("Edit2");return s(),k(R,null,[t(L,{class:"background-layout",style:q("min-width: 60vw; max-width: 90vw;"+i.dialog.main.style)},{default:r(()=>[C((s(),d(v,{class:"q-pa-none header-main",style:q(i.crud.config?.color?.header?"background: "+i.crud.config.color.header+" !important;":"")},{default:r(()=>[t(B,{class:"q-pr-none"},{default:r(()=>[t(j,null,{default:r(()=>[t(A,{class:"text-h6 text-white"},{default:r(()=>[Q(_(i.definition.title),1)]),_:1})]),_:1}),t(j,{side:""},{default:r(()=>[t(m,{class:"text-caption text-white q-pl-xs q-pr-xs q-mr-xs",flat:"",round:"",glossy:"",icon:"close",onClick:c.on_close_click},{default:r(()=>[t(G,null,{default:r(()=>[Q(_(o.$t("label.close")),1)]),_:1})]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["style"])),[[S,i.dialog.main.onDrag,void 0,{mouse:!0}]]),i.labels?.length?(s(),d(v,{key:0,class:"q-pa-sm q-mt-xs"},{default:r(()=>[(s(!0),k(R,null,E(i.labels,(a,g)=>(s(),d(Y,{key:g,color:i.chips[g%i.chips.length],"text-color":"white",class:"ellipsis-text"},{default:r(()=>[u("strong",null,[u("span",null,_(a.title)+":",1)]),u("span",M,_(a.value),1)]),_:2},1032,["color"]))),128))]),_:1})):f("",!0),t(v,{style:{"max-height":"80vh","overflow-y":"scroll !important"},class:"q-pa-xs"},{default:r(()=>[t(Z,{class:"table-sticky-header q-ma-sm",rows:i.table.rows,columns:i.table.columns,"visible-columns":i.table.visibles,"row-key":"_pk_",loading:i.table.loading,selection:i.crud.isObject(i.definition.table)?i.definition.table.selection:"single",selected:i.table.selected,"onUpdate:selected":n[1]||(n[1]=a=>i.table.selected=a),pagination:i.table.pagination,"onUpdate:pagination":n[2]||(n[2]=a=>i.table.pagination=a),dense:o.$q.screen.lt.md,"no-data-label":o.$t("error.data_not_available"),"rows-per-page-label":" ","selected-rows-label":a=>{},"rows-per-page-options":i.crud.isObject(i.definition.table)&&i.definition.table.page?.options?i.definition.table.page.options:[10,20,30],onRequest:c.do_request,"binary-state-sort":"",separator:i.crud.isObject(i.definition.table)?i.definition.table.separator:"cell",bordered:"",style:{"max-height":"72vh"}},{top:r(()=>[i.crud.isObject(i.definition.table)&&i.definition.table.selection==="multiple"&&i.crud.permission.deletes(i.permission)&&!i.onlyView?(s(),d(m,{key:0,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"negative",icon:"delete",disable:!i.table.selected.length,loading:i.table.deleting,onClick:c.on_delete_click},null,8,["disable","loading","onClick"])):f("",!0),i.crud.permission.add(i.permission)&&!i.onlyView?(s(),d(m,{key:1,glossy:"",round:"",dense:"",class:"q-ma-none q-mr-md",color:"teal",icon:"add",onClick:c.on_add_click},null,8,["onClick"])):f("",!0),t(H),i.search.filters?.length?(s(),d(m,{key:2,glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"deep-orange",icon:"search",onClick:c.on_search_click},{default:r(()=>[i.search.empty?f("",!0):(s(),d(F,{key:0,class:"led-green",floating:""}))]),_:1},8,["onClick"])):f("",!0),t(m,{glossy:"",round:"",dense:"",class:"q-ma-none q-ml-md",color:"indigo",icon:"refresh",loading:i.table.loading,onClick:c.on_refresh_click},null,8,["loading","onClick"])]),"no-data":r(({message:a})=>[u("div",W,[t(N,{size:"2em",name:"block"}),u("span",X,_(a),1)])]),loading:r(()=>[t(J,{showing:"",color:"primary"})]),"header-selection":r(a=>[i.crud.isObject(i.definition.table)&&i.definition.table.selection==="multiple"&&i.crud.permission.deletes(i.permission)&&!i.onlyView?(s(),k("div",$,[t(P,{dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":g=>a.selected=g},null,8,["modelValue","onUpdate:modelValue"])])):f("",!0)]),"body-selection":r(a=>[i.crud.isObject(i.definition.table)&&i.definition.table.selection==="multiple"&&i.crud.permission.deletes(i.permission)&&!i.onlyView?(s(),d(P,{key:0,dense:"",color:"primary",class:"q-ma-none q-ml-sm q-mr-sm",modelValue:a.selected,"onUpdate:modelValue":g=>a.selected=g},null,8,["modelValue","onUpdate:modelValue"])):i.crud.isObject(i.definition.table)&&i.crud.permission.delete(i.permission)&&!i.onlyView?(s(),d(m,{key:1,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"negative",icon:"delete",onClick:g=>c.on_delete_click(a)},null,8,["onClick"])):f("",!0),i.crud.permission.edit(i.permission)&&!i.onlyView?(s(),d(m,{key:2,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"primary",icon:"drive_file_rename_outline",onClick:g=>c.on_edit_click(a)},null,8,["onClick"])):f("",!0),i.crud.permission.view(i.permission)?(s(),d(m,{key:3,glossy:"",round:"",dense:"",size:"sm",class:"q-ma-none q-ml-xs q-mr-sm",color:"deep-purple",icon:"visibility",onClick:g=>c.on_view_click(a)},null,8,["onClick"])):f("",!0)]),pagination:r(a=>[a.pagesNumber>2?(s(),d(m,{key:0,glossy:"",size:"sm",icon:"first_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.firstPage},null,8,["disable","onClick"])):f("",!0),t(m,{glossy:"",size:"sm",icon:"chevron_left",color:"grey-8",round:"",dense:"",flat:"",disable:a.isFirstPage,onClick:a.prevPage},null,8,["disable","onClick"]),t(T,{dense:"",borderless:"",type:"number","input-class":"text-center q-ml-xs q-mr-xs","input-style":"max-width: 60px;",modelValue:i.table.pagination.page,"onUpdate:modelValue":[n[0]||(n[0]=g=>i.table.pagination.page=g),c.on_page_changed]},z({_:2},[i.crud.isObject(i.definition.table)&&i.crud.isObject(i.definition.table.page)&&i.definition.table.page.count===!0?{name:"append",fn:r(()=>[u("span",ee," / "+_(a.pagesNumber),1)]),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue"]),t(m,{glossy:"",size:"sm",icon:"chevron_right",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.nextPage},null,8,["disable","onClick"]),a.pagesNumber>2?(s(),d(m,{key:1,glossy:"",size:"sm",icon:"last_page",color:"grey-8",round:"",dense:"",flat:"",disable:a.isLastPage,onClick:a.lastPage},null,8,["disable","onClick"])):f("",!0)]),_:1},8,["rows","columns","visible-columns","loading","selection","selected","pagination","dense","no-data-label","rows-per-page-options","onRequest","separator"])]),_:1})]),_:1},8,["style"]),t(V,{modelValue:i.dialog.search.show,"onUpdate:modelValue":n[3]||(n[3]=a=>i.dialog.search.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[C(t(D,{parameters:i.dialog.search.parameters,onClose:c.on_close_dialog_search,style:q(i.dialog.search.style)},null,8,["parameters","onClose","style"]),[[S,i.dialog.search.onDrag,void 0,{mouse:!0}]])]),_:1},8,["modelValue"]),t(V,{modelValue:i.dialog.view.show,"onUpdate:modelValue":n[4]||(n[4]=a=>i.dialog.view.show=a),"transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[t(O,{parameters:i.dialog.view.parameters},null,8,["parameters"])]),_:1},8,["modelValue"]),t(V,{modelValue:i.dialog.edit.show,"onUpdate:modelValue":n[5]||(n[5]=a=>i.dialog.edit.show=a),persistent:"","transition-show":"slide-down","transition-hide":"none","backdrop-filter":"blur(1px)"},{default:r(()=>[t(I,{parameters:i.dialog.edit.parameters,onClose:c.on_close_dialog_edit},null,8,["parameters","onClose"])]),_:1},8,["modelValue"])],64)}const me=U(K,[["render",ie]]);export{me as default};
